# KeyViewer.ps1 (press Esc to exit)
Write-Host "Press keys (Esc to exit):"
while ($true) {
  $k = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
  "{0,-4} VK={1,-3} Char='{2}' Mods=[Ctrl:{3} Shift:{4} Alt:{5}]" -f `
    $k.KeyDown, $k.VirtualKeyCode, $k.Character, `
    ($k.ControlKeyState -band 8) -ne 0, `
    ($k.ControlKeyState -band 16) -ne 0, `
    ($k.ControlKeyState -band 2) -ne 0 | Write-Host
  if ($k.VirtualKeyCode -eq 27) { break }
}
